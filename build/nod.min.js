/*! Nod 2014-03-03, by Gorm Casper */
!function(a,b){"use strict";function c(){var a=arguments;return function(){for(var b=arguments,c=a.length;c--;)b=[a[c].apply(this,b)];return b[0]}}function d(a){return a[0]}function e(a){return a[a.length-1]}function f(a){var b=function(a,b){return Array.prototype.slice.call(a,b||0)},c=b(arguments,1);return function(){return a.apply(this,c.concat(b(arguments)))}}function g(a,b){var c=function(a,b){return Array.prototype.slice.call(a,b||0)};return b=b||a.length,function(){var d;return arguments.length<b?(d=b-arguments.length,b-d>0?g(f.apply(this,[a].concat(c(arguments))),d):f.apply(this,[a].concat(c(arguments)))):a.apply(this,arguments)}}function h(a){if(a&&a.constructor&&a.call&&a.apply)return a;if(a instanceof RegExp)return function(b){return a.test(b)};var b=a.split(":"),c=b.shift(),d=D[c];if(!d)throw new Error("I don't know how to check for: "+c);return d.apply(this,b)}function i(a){function b(a){$(a).on("toggle:isValid",d)}function d(){var a=!C.allAreValid();e.prop("disabled",a).toggleClass("disabled",a)}var e=$(a);return t(c(b,A("el")),C.items),d(),{add:b}}function j(a){return function(){var c=a.validate(),e=d(z(x(!0),a.getResults()))||a.validText;e!==b?a.textHolder.html(e).fadeIn():a.textHolder.hide(),a.group.toggleClass("has-success",c).toggleClass("has-error",!c),a.isValid!==c&&(a.isValid=c,$(a.el).trigger("toggle:isValid"))}}function l(a,b){$(b).on("keyup",B(j(a),700)).on("change blur",j(a))}function m(a){l(a,a.el);var b=u(function(a){return a.split(":")},a.validates);t(c(l.bind(null,a),e),z(c(w("same-as"),d),b))}function n(a){this.el=a,this.$el=$(this.el),this.group=this.$el.parents(".form-group"),this.textHolder=$("<span/>",{"class":"help-block nod-text"}).hide(),this.checks=[],this.validText="",this.validates=[],this.getValue=this.makeGetValue(),this.isValid=this.validate()||null,this.addTextHolderToDom()}function o(a){var b=c($,r("join"),s("selector"))(a);this.items=[],this.expandedMetrics=this.expandMetrics(a),t(this.addElement.bind(this),b),this.attachCheckersFromExpandedMetrics()}function p(a,b){C=new o(a),t(m,C.items);i(b.submitBtn)}var q=(console.log.bind(console),g(function(a,b){return b(a)})),r=g(function(a,b){return b[a]()}),s=g(function(a,b){for(var c=[],d=-1;++d<b.length;)b[d]&&c.push(b[d][a]);return c}),t=(g(function(a,b){for(var c=[],d=-1;++d<a.length;)-1!==b.indexOf(a[d])&&c.push(a[d]);return c}),g(function(a,b){if(b.forEach)return b.forEach(a);if(b.length===+b.length)for(var c=-1;++c<b.length;)a(b[c]);else for(var d in b)b.hasOwnProperty(d)&&a(b[d]);return b})),u=g(function(a,b){var c,d;if(b.map)return b.map(a);if(b.length===+b.length){for(c=[],d=-1;++d<b.length;)c.push(a(b[d]));return c}c={};for(var e in items_)b.hasOwnProperty(k)&&(c[e]=a(b[e]));return c}),v=g(function(a,b){for(var c=-1;++c<b.length;)if(!a(b[c]))return!1;return!0}),w=(g(function(a,b){for(var c=-1;++c<b.length;)if(a(b[c]))return!0;return!1}),g(function(a,b){return b===a})),x=g(function(a,b){return b!==a}),y=g(function(a,b){var c=b.length;if(c===+c){for(var d=-1;++d<c;)if(a(b[d]))return b[d]}else for(var e in b)if(b.hasOwnProperty(e)&&a(b[e]))return b[e]}),z=(g(function(a,b){for(var c=0;c<b.length;c++)if(b[c]===a)return c;return-1}),g(function(a,b){var c,d;if(b.filter)return b.filter(a);if(b.length===+b.length){for(c=[],d=-1;++d<b.length;)a(b[d])&&c.push(b[d]);return c}c={};for(var e in b)b.hasOwnProperty(e)&&a(b[e])&&(c[e]=b[e]);return c})),A=g(function(a,b){return b[a]}),B=function(a,b,c){var d,e,f,g,h;return function(){f=this,e=arguments,g=new Date;var i=function(){var j=new Date-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e)))},j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e)),h}},C=[],D={presence:function(){return function(a){return!!a}},empty:function(){return function(a){return 0===a.length||!1}},exact:function(a){return function(b){return b===a}},not:function(a){return function(b){return b!==a}},"same-as":function(a){if(1!==$(a).length)throw new Error("same-as selector must target one and only one element");return function(b){return b===$(a).val()}},min:function(a){return function(b){var c=isNaN(b)?b.length:+b;return c>=+a}},max:function(a){return function(b){var c=isNaN(b)?b.length:+b;return+a>=c}},between:function(a,b){return function(c){var d=isNaN(c)?c.length:+c;return d>=+a&&+b>=d}},"exact-length":function(a){return function(b){return b.length===+a}},integer:function(){return function(a){return E.int.test(a)}},"float":function(){return function(a){return E.float.test(a)}},email:function(){return function(a){return E.email.test(a)}}};D["one-of"]=D.presence,D["all-or-none"]=D.presence,D["min-length"]=D["min-num"]=D.min,D["max-length"]=D["max-num"]=D.max,D["between-length"]=D["between-num"]=D.between;var E={"int":/^\s*\d+\s*$/,"float":/^\s*[-+]?[0-9]+(\.[0-9]+)\s*?$/,email:/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/};n.prototype.makeGetValue=function(){return"checkbox"===this.$el.attr("type")?function(){return this.$el.is(":checked")}:function(){return $.trim(this.el.value)}},n.prototype.validate=function(){return v(w(!0),this.getResults())},n.prototype.getResults=function(){return u(q(this.getValue()),this.checks)},n.prototype.addTextHolderToDom=function(){var a=this.group.find(".nod-text"),b=this.$el.attr("type");"radio"===b&&a.length?this.textHolder=a:"radio"===b||"checkbox"===b?this.group.append(this.textHolder):this.$el.after(this.textHolder)},n.prototype.addCheck=function(a,b){this.checks.push(function(c){return a(c)?!0:b})},n.prototype.setValidText=function(a){this.validText=a},n.prototype.addValidate=function(a){this.validates.push(a)},o.prototype.add=function(a){var b=this.addElement(a);this.attachCheckersFromExpandedMetrics(b)},o.prototype.addElement=function(a){var b;return v(c(x(a),A("el")),this.items)&&(b=new n(a),this.items.push(b)),b},o.prototype.expandMetrics=u(function(a){return{$els:$(a.selector),check:h(a.validate),validate:a.validate,validText:a.validText,errorText:a.errorText}}),o.prototype.attachCheckersFromExpandedMetrics=function(a){var b=this.attachChecker,d=a?[a]:this.items;t(function(a){a.$els.each(function(){var e=y(c(w(this),A("el")),d);b(a,e)})},this.expandedMetrics)},o.prototype.attachChecker=function(a,b){b.addCheck(a.check,a.errorText),b.setValidText(a.validText),b.addValidate(a.validate)},o.prototype.allAreValid=function(){return v(c(w(!0),A("isValid")),this.items)},p.checkers=D,a.nod=p}(window);